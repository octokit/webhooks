{
  "$schema": "http://json-schema.org/draft-07/schema",
  "$id": "repository_vulnerability_alert",

  "type": "object",
  "required": ["action", "alert"],
  "properties": {
    "action": {
      "type": "string",
      "enum": ["create", "dismiss", "resolve"]
    },
    "alert": {
      "type": "object",
      "required": [
        "id",
        "affected_range",
        "affected_package_name",
        "external_reference",
        "external_identifier",
        "fixed_in"
      ],
      "properties": {
        "id": {
          "type": "integer"
        },
        "affected_range": {
          "type": "string"
        },
        "affected_package_name": {
          "type": "string"
        },
        "dismisser": {
          "$ref": "$user"
        },
        "dismiss_reason": {
          "type": "string"
        },
        "dismissed_at": {
          "type": "string"
        },
        "ghsa_id": {
          "type": "string"
        },
        "external_reference": {
          "type": "string"
        },
        "external_identifier": {
          "type": "string"
        },
        "fixed_in": {
          "type": "string"
        },
        "created_at": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "repository": {
      "$ref": "$repository"
    },
    "sender": {
      "$ref": "$user"
    },
    "organization": {
      "$ref": "$organization"
    }
  },
  "additionalProperties": false
}
